import{q as v,E as k,_ as w,I as E,G as D,s as S,b as n,c as y,d as e,t as o,e as u,v as x,x as _,F as g,z as f,j as C,w as b,n as p,f as I,p as N,h as Q}from"./index-8fc47cfa.js";const L=v.create({baseURL:"https://apps.onetwotrading.co.th/12chat"}),j=k("EmployeeData",{state:()=>({employees:[],loading:!1,error:null,selectedEmployee:null}),getters:{getEmployeesByDepartment(){return t=>this.employees.filter(l=>l.department===t)},getActiveEmployees(){return this.employees.filter(t=>t.status===1)},getAdminEmployees(){return this.employees.filter(t=>t.role==="admin")}},actions:{async getEmployeeList(){try{this.loading=!0;const t=await L.get("/api/users",{headers:{"Content-Type":"application/json"}});return t.data&&t.data.data&&(this.employees=t.data.data),t.data}catch(t){throw console.error("Error fetching employees:",t),this.error=t.message,t}finally{this.loading=!1}},setSelectedEmployee(t){this.selectedEmployee=t},clearSelectedEmployee(){this.selectedEmployee=null},clearError(){this.error=null}}});const V={name:"EmployeeView",components:{Icon:E},setup(){const t=j(),{employees:l,loading:d,error:a}=D(t);return{employeeStore:t,employees:l,loading:d,error:a}},data(){return{searchQuery:"",employeeSearchQuery:"",selectedDepartment:null,selectedEmployee:null}},computed:{departments(){const t=new Map;return t.set("all",{name:"ทั้งหมด",count:this.employees.length,employees:[...this.employees]}),this.employees.forEach(d=>{const a=d.department||"User Resign";t.has(a)||t.set(a,{name:a,count:0,employees:[]});const s=t.get(a);s.count++,s.employees.push(d)}),Array.from(t.values()).sort((d,a)=>d.name==="ทั้งหมด"?-1:a.name==="ทั้งหมด"?1:d.name.localeCompare(a.name))},filteredDepartments(){if(!this.searchQuery)return this.departments;const t=this.searchQuery.toLowerCase();return this.departments.filter(l=>l.name.toLowerCase().includes(t))},filteredDepartmentEmployees(){return this.selectedDepartment?this.filterEmployees(this.selectedDepartment.employees):this.filterEmployees(this.employees)}},created(){this.fetchEmployees()},methods:{async fetchEmployees(){try{await this.employeeStore.getEmployeeList(),this.selectedDepartment=null,console.log("Total employees:",this.employees.length)}catch(t){console.error("Error fetching employees:",t)}},filterEmployees(t){if(!this.employeeSearchQuery)return console.log("Showing all employees:",t.length),t;const l=this.employeeSearchQuery.toLowerCase(),d=t.filter(a=>a.fullName.toLowerCase().includes(l)||a.employeeID.toLowerCase().includes(l)||a.positon&&a.positon.toLowerCase().includes(l));return console.log("Filtered employees:",d.length),d},selectDepartment(t){console.log("Selecting department:",(t==null?void 0:t.name)||"ทั้งหมด"),this.selectedDepartment=t,this.employeeSearchQuery="";const l=this.filteredDepartmentEmployees;console.log("Employees to show:",l.length)},showEmployeeDetails(t){this.selectedEmployee=t},closeEmployeeDetails(){this.selectedEmployee=null}}},i=t=>(N("data-v-04ab009e"),t=t(),Q(),t),A={class:"p-4 sm:ml-24"},T={class:"p-4 mt-10"},U={class:"flex justify-between items-center mb-2"},z=i(()=>e("div",{class:"flex items-center gap-2"},[e("i",{class:"fas fa-users text-2xl text-blue-600 dark:text-blue-400"}),e("h1",{class:"text-xl font-bold text-gray-900 dark:text-white"},"รายการพนักงาน")],-1)),B={class:"text-sm text-gray-500 dark:text-gray-400"},M={class:"md:flex gap-2"},q={class:"w-full md:w-80 mb-4 md:mb-0"},F={class:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm"},R={class:"p-4 border-b border-gray-200 dark:border-gray-700"},G={class:"relative"},H={class:"max-h-[calc(100vh-250px)] overflow-y-auto"},J={class:"divide-y divide-gray-200 dark:divide-gray-700"},K=["onClick"],O={class:"flex items-center"},P={class:"text-sm font-medium text-gray-900 dark:text-white"},W={class:"text-xs text-gray-500 dark:text-gray-400 bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded-full"},X={class:"flex-1"},Y={class:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-sm"},Z={class:"p-4 border-b border-gray-200 dark:border-gray-700"},$={class:"flex items-center justify-between"},ee={class:"flex items-center gap-2"},te=i(()=>e("i",{class:"fas fa-users text-xl text-blue-600 dark:text-blue-400"},null,-1)),se={class:"text-lg font-bold text-gray-900 dark:text-white"},re={class:"text-sm font-normal text-gray-500 dark:text-gray-400 ml-2"},le={class:"relative"},oe={key:0,class:"overflow-x-auto max-h-[calc(100vh-250px)] overflow-y-auto"},ae={class:"w-full text-sm text-left"},de=i(()=>e("thead",{class:"text-xs sticky top-0 z-10 text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3"},"พนักงาน"),e("th",{scope:"col",class:"px-6 py-3"},"รหัสพนักงาน"),e("th",{scope:"col",class:"px-6 py-3"},"ตำแหน่ง"),e("th",{scope:"col",class:"px-6 py-3"},"อีเมล"),e("th",{scope:"col",class:"px-6 py-3"},"สถานะ")])],-1)),ie={class:"divide-y divide-gray-200 dark:divide-gray-700"},ce=["onClick"],ne={class:"px-6 py-4"},ye={class:"flex items-center space-x-3"},pe=["src","alt"],me={class:"font-medium text-gray-900 dark:text-white"},ge={class:"px-6 py-4 text-gray-900 dark:text-white"},he={class:"px-6 py-4 text-gray-900 dark:text-white"},ue={class:"px-6 py-4 text-gray-900 dark:text-white"},xe={class:"px-6 py-4"},_e={key:1,class:"p-12 text-center"},fe={class:"text-gray-500 dark:text-gray-400"},be={class:"fixed inset-0 z-50 overflow-y-auto"},ve={class:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0"},ke={class:"bg-white dark:bg-gray-800 px-6 pt-6 pb-4 sm:p-8"},we={class:"flex items-start justify-between"},Ee={class:"flex items-center space-x-8"},De={class:"w-40 h-40 rounded-lg overflow-hidden bg-gray-100 dark:bg-gray-700"},Se=["src","alt"],Ce={class:"text-2xl font-medium leading-6 text-gray-900 dark:text-white mb-2"},Ie={class:"text-xl text-gray-500 dark:text-gray-400 mb-4"},Ne={class:"mt-3 flex items-center space-x-3"},Qe=i(()=>e("span",{class:"sr-only"},"Close",-1)),Le=i(()=>e("i",{class:"fas fa-times text-2xl"},null,-1)),je=[Qe,Le],Ve={class:"bg-white dark:bg-gray-800 px-6 pt-2 pb-6 sm:p-8"},Ae={class:"grid grid-cols-2 gap-8"},Te={class:"space-y-4"},Ue=i(()=>e("p",{class:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-1"},"รหัสพนักงาน",-1)),ze={class:"text-lg text-gray-900 dark:text-white"},Be=i(()=>e("p",{class:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-1"},"ชื่อผู้ใช้",-1)),Me={class:"text-lg text-gray-900 dark:text-white"},qe=i(()=>e("p",{class:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-1"},"ตำแหน่ง",-1)),Fe={class:"text-lg text-gray-900 dark:text-white"},Re={class:"space-y-4"},Ge=i(()=>e("p",{class:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-1"},"แผนก",-1)),He={class:"text-lg text-gray-900 dark:text-white"},Je=i(()=>e("p",{class:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-1"},"บริษัท",-1)),Ke={class:"text-lg text-gray-900 dark:text-white"},Oe=i(()=>e("p",{class:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-1"},"อีเมล",-1)),Pe={class:"text-lg text-gray-900 dark:text-white"};function We(t,l,d,a,s,c){const h=S("Icon");return n(),y(g,null,[e("div",A,[e("div",T,[e("div",U,[z,e("div",B," ทั้งหมด "+o(a.employees.length)+" คน ",1)]),e("div",M,[e("div",q,[e("div",F,[e("div",R,[e("div",G,[u(e("input",{type:"text","onUpdate:modelValue":l[0]||(l[0]=r=>s.searchQuery=r),placeholder:"ค้นหาแผนก...",class:"w-full pl-10 pr-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[x,s.searchQuery]]),_(h,{class:"absolute left-3 top-3 text-gray-400",icon:"cuida:search-outline",width:"18",height:"18"})])]),e("div",H,[e("ul",J,[(n(!0),y(g,null,f(c.filteredDepartments,r=>{var m;return n(),y("li",{key:r.name},[e("a",{href:"#",onClick:b(Xe=>c.selectDepartment(r.name==="ทั้งหมด"?null:r),["prevent"]),class:p(["flex items-center justify-between px-4 py-3 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",r.name==="ทั้งหมด"&&!s.selectedDepartment||((m=s.selectedDepartment)==null?void 0:m.name)===r.name?"bg-blue-50 dark:bg-blue-900/20":""])},[e("div",O,[e("i",{class:p(["mr-3",r.name==="ทั้งหมด"?"fas fa-users":"fas fa-building","text-gray-400"])},null,2),e("span",P,o(r.name),1)]),e("span",W,o(r.count)+" คน ",1)],10,K)])}),128))])])])]),e("div",X,[e("div",Y,[e("div",Z,[e("div",$,[e("div",ee,[te,e("h2",se,[C(o(s.selectedDepartment?s.selectedDepartment.name:"พนักงานทั้งหมด")+" ",1),e("span",re," ("+o(c.filteredDepartmentEmployees.length)+" คน) ",1)])]),e("div",le,[u(e("input",{type:"text","onUpdate:modelValue":l[1]||(l[1]=r=>s.employeeSearchQuery=r),placeholder:"ค้นหาพนักงาน...",class:"w-64 pl-10 pr-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[x,s.employeeSearchQuery]]),_(h,{class:"absolute left-3 top-3 text-gray-400",icon:"cuida:search-outline",width:"18",height:"18"})])])]),c.filteredDepartmentEmployees.length>0?(n(),y("div",oe,[e("table",ae,[de,e("tbody",ie,[(n(!0),y(g,null,f(c.filteredDepartmentEmployees,r=>(n(),y("tr",{key:r.employeeID,class:"bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer",onClick:m=>c.showEmployeeDetails(r)},[e("td",ne,[e("div",ye,[e("img",{src:r.imgUrl,alt:r.fullName,class:"w-8 h-8 rounded-full object-cover"},null,8,pe),e("div",me,o(r.fullName),1)])]),e("td",ge,o(r.employeeID),1),e("td",he,o(r.positon||"ไม่ระบุตำแหน่ง"),1),e("td",ue,o(r.mail),1),e("td",xe,[e("span",{class:p(["px-2 py-1 text-xs rounded-full",r.status===1?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"])},o(r.status===1?"Active":"Inactive"),3)])],8,ce))),128))])])])):(n(),y("div",_e,[e("p",fe,o(s.employeeSearchQuery?"ไม่พบพนักงานที่ค้นหา":"ไม่พบพนักงานในแผนกนี้"),1)]))])])])])]),s.selectedEmployee?(n(),y("div",{key:0,class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity z-50",onClick:l[4]||(l[4]=(...r)=>c.closeEmployeeDetails&&c.closeEmployeeDetails(...r))},[e("div",be,[e("div",ve,[e("div",{class:"relative transform overflow-hidden rounded-lg bg-white dark:bg-gray-800 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-3xl",onClick:l[3]||(l[3]=b(()=>{},["stop"]))},[e("div",ke,[e("div",we,[e("div",Ee,[e("div",De,[e("img",{src:s.selectedEmployee.imgUrl,alt:s.selectedEmployee.fullName,class:"w-full h-full object-cover"},null,8,Se)]),e("div",null,[e("h3",Ce,o(s.selectedEmployee.fullName),1),e("p",Ie,o(s.selectedEmployee.fullNameThai),1),e("div",Ne,[e("span",{class:p(["px-3 py-1 text-sm rounded-full",s.selectedEmployee.status===1?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"])},o(s.selectedEmployee.status===1?"Active":"Inactive"),3),e("span",{class:p(["px-3 py-1 text-sm rounded-full",s.selectedEmployee.role==="admin"?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"])},o(s.selectedEmployee.role==="admin"?"Admin":"User"),3)])])]),e("button",{type:"button",class:"rounded-md bg-white dark:bg-gray-800 text-gray-400 hover:text-gray-500 focus:outline-none",onClick:l[2]||(l[2]=(...r)=>c.closeEmployeeDetails&&c.closeEmployeeDetails(...r))},je)])]),e("div",Ve,[e("div",Ae,[e("div",Te,[e("div",null,[Ue,e("p",ze,o(s.selectedEmployee.employeeID),1)]),e("div",null,[Be,e("p",Me,o(s.selectedEmployee.userName),1)]),e("div",null,[qe,e("p",Fe,o(s.selectedEmployee.positon||"ไม่ระบุตำแหน่ง"),1)])]),e("div",Re,[e("div",null,[Ge,e("p",He,o(s.selectedEmployee.department||"ไม่ระบุแผนก"),1)]),e("div",null,[Je,e("p",Ke,o(s.selectedEmployee.company||"ไม่ระบุบริษัท"),1)]),e("div",null,[Oe,e("p",Pe,o(s.selectedEmployee.mail),1)])])])])])])])])):I("",!0)],64)}const Ze=w(V,[["render",We],["__scopeId","data-v-04ab009e"]]);export{Ze as default};
